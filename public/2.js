(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{2:function(t,a,e){"use strict";function s(t,a,e,s,i,n,r,o){var l,c="function"==typeof t?t.options:t;if(a&&(c.render=a,c.staticRenderFns=e,c._compiled=!0),s&&(c.functional=!0),n&&(c._scopeId="data-v-"+n),r?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},c._ssrRegister=l):i&&(l=o?function(){i.call(this,this.$root.$options.shadowRoot)}:i),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(t,a){return l.call(a),d(t,a)}}else{var _=c.beforeCreate;c.beforeCreate=_?[].concat(_,l):[l]}return{exports:t,options:c}}e.d(a,"a",(function(){return s}))},24:function(t,a,e){"use strict";var s=e(6);e.n(s).a},25:function(t,a,e){(t.exports=e(7)(!1)).push([t.i,"\n._chem[data-v-c7cff5ac] {\n    background: #853239;\n    color: #fff;\n}\n._create[data-v-c7cff5ac] {\n    background: #E0735E;\n    border-color: #E0735E;\n}\n._257_btn[data-v-c7cff5ac] {\n    background: #0099AB;\n    color: #fff;\n}\n",""])},29:function(t,a,e){"use strict";e.r(a);var s=e(0),i=e.n(s),n={data:function(){return{leads:[],managers:[],pagination:{},modalTitle:"ВЫБЕРИТЕ МЕНЕДЖЕРА ДЛЯ ЗАПРОСА",manager_id:0,city_id:0,selectCity_id:1,type:0,first_name:"",email:"",phone:"",comment:"",errors:[]}},props:{sourceList:Array,companies:Array,cities:Array},methods:{getLeads:function(t){var a=this;0===this.city_id?("number"==typeof(t=t||"/api/leads")&&(t="/api/leads?page="+t),i.a.get(t).then((function(t){a.leads=t.data.data,a.makePagination(t.data.links,t.data.meta)})).catch((function(t){console.log(t)}))):("number"==typeof(t=t||"/api/leads/city")&&(t="/api/leads/city?page="+t),i.a.post(t,{city_id:this.city_id}).then((function(t){a.leads=t.data.data,a.makePagination(t.data.links,t.data.meta)})).catch((function(t){console.log(t)})))},makePagination:function(t,a){var e;e={prev_page_url:t.prev,next_page_url:t.next,last_page_url:t.last,first_page_url:t.first,current_page:a.current_page,last_page:a.last_page},this.pagination=e,console.log(e)},getManagers:function(){var t=this;i.a.get("/api/managers").then((function(a){t.managers=a.data.data})).catch((function(t){console.log(t)}))},setLeadForManager:function(){var t=this;i.a.post("/call_center/manager/set/lead",{lead_id:$("#send_btn").data("id"),manager_id:this.manager_id,_token:$("input[name='_token']").attr("content")}).then((function(a){t.getLeads(),$("#modal_lead").addClass("fade").modal("toggle"),console.log(a)})).catch((function(t){console.log(t)}))},selectManager:function(t){$("#send_btn").data("id",t),$("#modal_lead").removeClass("fade").modal("toggle"),this.modalTitle=this.modalTitle+" #"+t},getObjectValue:function(t,a){return t.find((function(t){return t.id===a})).title},createLeadForm:function(){$("#create_lead").removeClass("fade").modal("toggle")},createLead:function(){var t=this;i.a.post("/call_center/create/lead",{first_name:this.first_name,city_id:this.selectCity_id,type:this.type,email:this.email,phone:this.phone,comment:this.comment}).then((function(a){$("#create_lead").addClass("fade").modal("toggle"),t.getLeads(),console.log(a)})).catch((function(a){422===a.response.status&&(t.errors=a.response.data.errors)}))}},created:function(){this.leads=this.getLeads(),this.managers=this.getManagers()}},r=(e(24),e(2)),o=Object(r.a)(n,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"row"},[t._m(0),t._v(" "),e("div",{staticClass:"col-md-2"},[e("div",{staticClass:"form-group"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.city_id,expression:"city_id"}],staticClass:"form-control",on:{change:[function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.city_id=a.target.multiple?e:e[0]},function(a){return t.getLeads()}]}},[e("option",{attrs:{value:"0"}},[t._v("Все")]),t._v(" "),t._l(t.cities,(function(a){return e("option",{key:a.id,domProps:{value:a.id}},[t._v(t._s(a.title))])}))],2)])]),t._v(" "),e("div",{staticClass:"col-md-2"}),t._v(" "),e("div",{staticClass:"col-md-7 text-right"},[e("div",{staticClass:"btn-group",attrs:{role:"button"}},[e("button",{staticClass:"btn btn-primary _create",on:{click:function(a){return t.createLeadForm()}}},[t._v("Создать запрос")]),t._v(" "),e("button",{staticClass:"btn btn-default _257_btn"},[t._v("Загрузить отчет 257.kz")]),t._v(" "),e("button",{staticClass:"btn btn-default _chem"},[t._v("Загрузить отчет chemodan.kz")])])])]),t._v(" "),e("nav",{attrs:{"aria-label":"..."}},[e("ul",{staticClass:"pagination"},[e("li",{staticClass:"page-item",class:[{disabled:!t.pagination.prev_page_url}]},[e("a",{staticClass:"page-link",attrs:{href:"#",tabindex:"-1"},on:{click:function(a){return t.getLeads(t.pagination.prev_page_url)}}},[t._v("Предыдущая")])]),t._v(" "),t._l(t.pagination.last_page,(function(a){return e("li",{staticClass:"page-item",class:[{disabled:a==t.pagination.current_page}]},[a<=10?e("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(e){return t.getLeads(a)}}},[t._v("\n                    "+t._s(a)+"\n                    "),a==t.pagination.current_page?e("span",{staticClass:"sr-only"},[t._v("(current)")]):t._e()]):t._e()])})),t._v(" "),e("li",{staticClass:"page-item",class:[{disabled:!t.pagination.next_page_url}]},[e("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(a){return t.getLeads(t.pagination.next_page_url)}}},[t._v("Следующая")])])],2)]),t._v(" "),e("table",{staticClass:"table leads_table table-bordered table-striped"},[t._m(1),t._v(" "),e("tbody",t._l(t.leads,(function(a){return e("tr",[e("td",[t._v(t._s(a.id))]),t._v(" "),e("td",[t._v(t._s(a.name))]),t._v(" "),e("td",[t._v(t._s(a.phone))]),t._v(" "),e("td",[t._v(t._s(t.sourceList[a.type]))]),t._v(" "),e("td",[t._v(t._s(t.cities[a.city_id-1].title))]),t._v(" "),e("td",[t._v(t._s(a.comment))]),t._v(" "),e("td",["0"==a.m_type?e("div",{staticClass:"status_btn"},[e("div",[t._v(t._s(a.user_name+" "+a.last_name))]),t._v(" "),e("div",{staticClass:"_completed"})]):t._e(),t._v(" "),"2"==a.m_type?e("div",{staticClass:"status_btn"},[e("div",[t._v(t._s(a.user_name+" "+a.last_name))]),t._v(" "),e("div",{staticClass:"_canceled"})]):t._e(),t._v(" "),"1"==a.m_type?e("div",{staticClass:"status_btn"},[e("div",[t._v(t._s(a.user_name+" "+a.last_name))]),t._v(" "),e("div",{staticClass:"_processed"})]):t._e(),t._v(" "),"1"==a.ss?e("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.selectManager(a.id)}}},[t._v("Выбрать Менеджера")]):t._e()])])})),0)]),t._v(" "),e("nav",{attrs:{"aria-label":"..."}},[e("ul",{staticClass:"pagination"},[e("li",{staticClass:"page-item",class:[{disabled:!t.pagination.prev_page_url}]},[e("a",{staticClass:"page-link",attrs:{href:"#",tabindex:"-1"},on:{click:function(a){return t.getLeads(t.pagination.prev_page_url)}}},[t._v("Предыдущая")])]),t._v(" "),t._l(t.pagination.last_page,(function(a){return e("li",{staticClass:"page-item",class:[{disabled:a==t.pagination.current_page}]},[a<=10?e("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(e){return t.getLeads(a)}}},[t._v("\n                    "+t._s(a)+"\n                    "),a==t.pagination.current_page?e("span",{staticClass:"sr-only"},[t._v("(current)")]):t._e()]):t._e()])})),t._v(" "),e("li",{staticClass:"page-item",class:[{disabled:!t.pagination.next_page_url}]},[e("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(a){return t.getLeads(t.pagination.next_page_url)}}},[t._v("Следующая")])])],2)]),t._v(" "),e("div",{staticClass:"modal fade",attrs:{id:"modal_lead",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalCenterTitle","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog modal-dialog-centered",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLongTitle"}},[t._v(t._s(t.modalTitle))]),t._v(" "),t._m(2)]),t._v(" "),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"manager_id"}},[t._v("Выберите менеджера")]),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.manager_id,expression:"manager_id"}],staticClass:"form-control",attrs:{id:"manager_id"},on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.manager_id=a.target.multiple?e:e[0]}}},t._l(t.managers,(function(a){return e("option",{key:a.id,domProps:{value:a.id}},[t._v("\n                                        "+t._s(a.name+" "+a.last_name+", "+t.getObjectValue(t.cities,a.city_id)+", "+t.getObjectValue(t.companies,a.company_id))+"\n                                    ")])})),0)])])])]),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"button",id:"send_btn","data-id":"0"},on:{click:function(a){return t.setLeadForManager()}}},[t._v("Принудительно присвоить запрос")])])])])]),t._v(" "),e("div",{staticClass:"modal fade",attrs:{id:"create_lead",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalCenterTitle","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog modal-dialog-centered",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(3),t._v(" "),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"form-group"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.selectCity_id,expression:"selectCity_id"}],staticClass:"form-control",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.selectCity_id=a.target.multiple?e:e[0]}}},t._l(t.cities,(function(a){return e("option",{key:a.id,domProps:{value:a.id}},[t._v(t._s(a.title))])})),0)]),t._v(" "),e("div",{staticClass:"form-group"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.type,expression:"type"}],staticClass:"form-control",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.type=a.target.multiple?e:e[0]}}},t._l(t.sourceList,(function(a,s){return e("option",{key:s,domProps:{value:s}},[t._v(t._s(a))])})),0)]),t._v(" "),e("div",{staticClass:"form-group"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.first_name,expression:"first_name"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Имя"},domProps:{value:t.first_name},on:{input:function(a){a.target.composing||(t.first_name=a.target.value)}}}),t._v(" "),t.errors.first_name?e("span",{staticClass:"error alert-danger"},[t._v(t._s(t.errors.first_name[0]))]):t._e()]),t._v(" "),e("div",{staticClass:"form-group"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control",attrs:{type:"email",placeholder:"Email"},domProps:{value:t.email},on:{input:function(a){a.target.composing||(t.email=a.target.value)}}}),t._v(" "),t.errors.email?e("span",{staticClass:"error alert-danger"},[t._v(t._s(t.errors.email[0]))]):t._e()]),t._v(" "),e("div",{staticClass:"form-group"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],staticClass:"form-control",attrs:{id:"phone_number",type:"text",placeholder:"Телефон"},domProps:{value:t.phone},on:{input:function(a){a.target.composing||(t.phone=a.target.value)}}}),t._v(" "),t.errors.phone?e("span",{staticClass:"error alert-danger"},[t._v(t._s(t.errors.phone[0]))]):t._e()]),t._v(" "),e("div",{staticClass:"form-group"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],staticClass:"form-control",attrs:{cols:"30",rows:"3",placeholder:"Комментарий"},domProps:{value:t.comment},on:{input:function(a){a.target.composing||(t.comment=a.target.value)}}}),t._v(" "),t.errors.comment?e("span",{staticClass:"error alert-danger"},[t._v(t._s(t.errors.comment[0]))]):t._e()]),t._v(" "),e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(a){return t.createLead()}}},[t._v("Создать запрос")])])])])]),t._v(" "),e("div",{staticClass:"modal-footer"})])])])])}),[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col-md-1"},[a("div",{staticClass:"form-group"},[a("h6",[this._v("Сортировка: ")])])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",{staticClass:"thead-light"},[e("th",{attrs:{width:"100"}},[t._v("Дата")]),t._v(" "),e("th",{attrs:{width:"100"}},[t._v("Имя")]),t._v(" "),e("th",{attrs:{width:"150"}},[t._v("Тел")]),t._v(" "),e("th",{attrs:{width:"150"}},[t._v("Источник")]),t._v(" "),e("th",{attrs:{width:"100"}},[t._v("Город")]),t._v(" "),e("th",{attrs:{width:"250"}},[t._v("Комментарии")]),t._v(" "),e("th",{attrs:{width:"200"}},[t._v("Подтверждение")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("Создать запрос")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])])}],!1,null,"c7cff5ac",null);a.default=o.exports},6:function(t,a,e){var s=e(25);"string"==typeof s&&(s=[[t.i,s,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(8)(s,i);s.locals&&(t.exports=s.locals)}}]);